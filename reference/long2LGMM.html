<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Long data to wide latent growth mixture model — long2LGMM • MplusAutomation</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Long data to wide latent growth mixture model — long2LGMM"><meta name="description" content="This function streamlines the process of converting long data into a format
that Mplus can use for latent growth mixture models in wide form.  It makes
use of continuous time scores, and these time scores must be supplied as
variables in the R dataset.  For the conversion to wide form, it is assumed
that although assessments may have happened in continuous time, a discrete
number of assessments (likely ismilar for all participants) were collected."><meta property="og:description" content="This function streamlines the process of converting long data into a format
that Mplus can use for latent growth mixture models in wide form.  It makes
use of continuous time scores, and these time scores must be supplied as
variables in the R dataset.  For the conversion to wide form, it is assumed
that although assessments may have happened in continuous time, a discrete
number of assessments (likely ismilar for all participants) were collected."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MplusAutomation</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/submitModels.html">Submitting Many Mplus Models to an HPC with submitModels()</a></li>
    <li><a class="dropdown-item" href="../articles/vignette.html">MplusAutomation Examples</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/michaelhallquist/MplusAutomation/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Long data to wide latent growth mixture model</h1>
      <small class="dont-index">Source: <a href="https://github.com/michaelhallquist/MplusAutomation/blob/master/R/trainlgmm.R" class="external-link"><code>R/trainlgmm.R</code></a></small>
      <div class="d-none name"><code>long2LGMM.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function streamlines the process of converting long data into a format
that Mplus can use for latent growth mixture models in wide form.  It makes
use of continuous time scores, and these time scores must be supplied as
variables in the R dataset.  For the conversion to wide form, it is assumed
that although assessments may have happened in continuous time, a discrete
number of assessments (likely ismilar for all participants) were collected.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">long2LGMM</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">idvar</span>,</span>
<span>  <span class="va">assessmentvar</span>,</span>
<span>  <span class="va">dv</span>,</span>
<span>  <span class="va">timevars</span>,</span>
<span>  misstrick <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  k <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Trajectory Model"</span>,</span>
<span>  base <span class="op">=</span> <span class="st">"trajmodel_"</span>,</span>
<span>  run <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  processors <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  starts <span class="op">=</span> <span class="st">"500 100"</span>,</span>
<span>  <span class="va">newdata</span>,</span>
<span>  cov <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"un"</span>, <span class="st">"independent"</span>, <span class="st">"intercept"</span>, <span class="st">"zero"</span><span class="op">)</span>,</span>
<span>  <span class="va">model</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data frame in long format (i.e., multiple rows per ID).</p></dd>


<dt id="arg-idvar">idvar<a class="anchor" aria-label="anchor" href="#arg-idvar"></a></dt>
<dd><p>A character string of the variable name in the dataset
that is the ID variable.</p></dd>


<dt id="arg-assessmentvar">assessmentvar<a class="anchor" aria-label="anchor" href="#arg-assessmentvar"></a></dt>
<dd><p>A character string of the variable name in the dataset that
indicates the particular assessment point for each timepoint.</p></dd>


<dt id="arg-dv">dv<a class="anchor" aria-label="anchor" href="#arg-dv"></a></dt>
<dd><p>A character string of the dependent variable name.</p></dd>


<dt id="arg-timevars">timevars<a class="anchor" aria-label="anchor" href="#arg-timevars"></a></dt>
<dd><p>A character vector of the time variables.
Can be a single variable or more than one.  By allowing more than one variable,
it is easy to include linear; linear and quadratic; it is also possible to
calculate splines in R and pass these. The variable names should be 7 characters
or fewer, each.</p></dd>


<dt id="arg-misstrick">misstrick<a class="anchor" aria-label="anchor" href="#arg-misstrick"></a></dt>
<dd><p>A logical value whether to set values of the DV where a time variable
is missing to missing as well.  Defaults to <code>TRUE</code>.</p></dd>


<dt id="arg-k">k<a class="anchor" aria-label="anchor" href="#arg-k"></a></dt>
<dd><p>An integer indicating the number of distinct classes to test.
Currently must be greater than 0 and less than 10.</p></dd>


<dt id="arg-title">title<a class="anchor" aria-label="anchor" href="#arg-title"></a></dt>
<dd><p>A character string giving a title for the model</p></dd>


<dt id="arg-base">base<a class="anchor" aria-label="anchor" href="#arg-base"></a></dt>
<dd><p>A character string providing a base name for model outputs,
that is combined with the number of classes.</p></dd>


<dt id="arg-run">run<a class="anchor" aria-label="anchor" href="#arg-run"></a></dt>
<dd><p>A logical value whether or not to run the models or only
create the data and input files, but not run them.</p></dd>


<dt id="arg-processors">processors<a class="anchor" aria-label="anchor" href="#arg-processors"></a></dt>
<dd><p>An integer value indicating the number of processors to use.</p></dd>


<dt id="arg-starts">starts<a class="anchor" aria-label="anchor" href="#arg-starts"></a></dt>
<dd><p>A character string passed to Mplus providing the number of
random starts and iterations</p></dd>


<dt id="arg-newdata">newdata<a class="anchor" aria-label="anchor" href="#arg-newdata"></a></dt>
<dd><p>A data frame of new values to use for generating predicted
trajectories by class.</p></dd>


<dt id="arg-cov">cov<a class="anchor" aria-label="anchor" href="#arg-cov"></a></dt>
<dd><p>A character string indicating the random covariance structure to use</p></dd>


<dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>An optional argument, can pass an existing model, the output from
mplusModeler().</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>One valuable feature of this function is that it makes it possible to feed
any continuous time scores to Mplus for mixture modelling.  For example,
continuous linear time is straightforward, but so to are quadratic
time models or piecewise models.  Using facilities in R, spline models
are also comparatively easy to specify.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co">## Simulate Some Data from 3 classes</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">MASS</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">allcoef</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">200</span>,</span></span>
<span class="r-in"><span>                   mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span>, <span class="fl">0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   Sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.2</span>, <span class="fl">.1</span>, <span class="fl">.01</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   empirical <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">200</span>,</span></span>
<span class="r-in"><span>                   mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3.35</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   Sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.2</span>, <span class="fl">.1</span>, <span class="fl">.1</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   empirical <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">200</span>,</span></span>
<span class="r-in"><span>                   mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3.35</span>, <span class="fl">2</span>, <span class="op">-</span><span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   Sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.2</span>, <span class="fl">.1</span>, <span class="fl">.1</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   empirical <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">allcoef</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">allcoef</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">allcoef</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Class"</span>, <span class="st">"I"</span>, <span class="st">"L"</span>, <span class="st">"Q"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">allcoef</span><span class="op">$</span><span class="va">ID</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">allcoef</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">allcoef</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    ID <span class="op">=</span> <span class="va">allcoef</span><span class="op">$</span><span class="va">ID</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    Class <span class="op">=</span> <span class="va">allcoef</span><span class="op">$</span><span class="va">Class</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    Assess <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">11</span>,</span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">11</span>, min <span class="op">=</span> <span class="op">-</span><span class="fl">2</span>, max <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">out</span><span class="op">$</span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">11</span>,</span></span>
<span class="r-in"><span>    mean <span class="op">=</span> <span class="va">allcoef</span><span class="op">$</span><span class="va">I</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="va">allcoef</span><span class="op">$</span><span class="va">L</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">*</span> <span class="va">out</span><span class="op">$</span><span class="va">x</span> <span class="op">+</span> <span class="va">allcoef</span><span class="op">$</span><span class="va">Q</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">*</span> <span class="va">out</span><span class="op">$</span><span class="va">x</span><span class="op">^</span><span class="fl">2</span>,</span></span>
<span class="r-in"><span>    sd <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## create splines</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">splines</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">time_splines</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/splines/ns.html" class="external-link">ns</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">x</span>, df <span class="op">=</span> <span class="fl">3</span>, Boundary.knots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">x</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.02</span>, <span class="fl">.98</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d</span><span class="op">$</span><span class="va">t1</span> <span class="op">&lt;-</span> <span class="va">time_splines</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">d</span><span class="op">$</span><span class="va">t2</span> <span class="op">&lt;-</span> <span class="va">time_splines</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">d</span><span class="op">$</span><span class="va">t3</span> <span class="op">&lt;-</span> <span class="va">time_splines</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">d</span><span class="op">$</span><span class="va">xq</span> <span class="op">&lt;-</span> <span class="va">d</span><span class="op">$</span><span class="va">x</span><span class="op">^</span><span class="fl">2</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## create new data to be used for predictions</span></span></span>
<span class="r-in"><span><span class="va">nd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>ID <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                 x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="op">-</span><span class="fl">2</span>, to <span class="op">=</span> <span class="fl">2</span>, by <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nd.splines</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">time_splines</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   <span class="fu"><a href="https://rdrr.io/r/splines/ns.html" class="external-link">ns</a></span><span class="op">(</span><span class="va">nd</span><span class="op">$</span><span class="va">x</span>, df <span class="op">=</span> <span class="va">degree</span>, knots <span class="op">=</span> <span class="va">knots</span>,</span></span>
<span class="r-in"><span>                      Boundary.knots <span class="op">=</span> <span class="va">Boundary.knots</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nd</span><span class="op">$</span><span class="va">t1</span> <span class="op">&lt;-</span> <span class="va">nd.splines</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">nd</span><span class="op">$</span><span class="va">t2</span> <span class="op">&lt;-</span> <span class="va">nd.splines</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">nd</span><span class="op">$</span><span class="va">t3</span> <span class="op">&lt;-</span> <span class="va">nd.splines</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">nd</span><span class="op">$</span><span class="va">xq</span> <span class="op">&lt;-</span> <span class="va">nd</span><span class="op">$</span><span class="va">x</span><span class="op">^</span><span class="fl">2</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## create a tuning grid of models to try</span></span></span>
<span class="r-in"><span><span class="co">## all possible combinations are created of different time trends</span></span></span>
<span class="r-in"><span><span class="co">## different covariance structures of the random effects</span></span></span>
<span class="r-in"><span><span class="co">## and different number of classes</span></span></span>
<span class="r-in"><span><span class="va">tuneGrid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  dv <span class="op">=</span> <span class="st">"y"</span>,</span></span>
<span class="r-in"><span>  timevars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"t1"</span>, <span class="st">"t2"</span>, <span class="st">"t3"</span><span class="op">)</span>, <span class="st">"x"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"xq"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  starts <span class="op">=</span> <span class="st">"2 1"</span>,</span></span>
<span class="r-in"><span>  cov <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"independent"</span>, <span class="st">"zero"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  k <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">3L</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  processors <span class="op">=</span> <span class="fl">1L</span>, run <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  misstrick <span class="op">=</span> <span class="cn">TRUE</span>, stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tuneGrid</span><span class="op">$</span><span class="va">title</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"linear"</span>, <span class="st">"quad"</span>, <span class="st">"spline"</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">tuneGrid</span><span class="op">$</span><span class="va">timevars</span>, <span class="va">length</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  <span class="st">"_"</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">tuneGrid</span><span class="op">$</span><span class="va">cov</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">==</span><span class="fl">4</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span> <span class="kw">else</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="st">"_"</span>,</span></span>
<span class="r-in"><span>  <span class="va">tuneGrid</span><span class="op">$</span><span class="va">k</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tuneGrid</span><span class="op">$</span><span class="va">base</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"linear"</span>, <span class="st">"quad"</span>, <span class="st">"spline"</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">tuneGrid</span><span class="op">$</span><span class="va">timevars</span>, <span class="va">length</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  <span class="st">"_"</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">tuneGrid</span><span class="op">$</span><span class="va">cov</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">==</span><span class="fl">4</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span> <span class="kw">else</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## example using long2LGMM to fit one model at a time</span></span></span>
<span class="r-in"><span><span class="va">mres</span> <span class="op">&lt;-</span> <span class="fu">long2LGMM</span><span class="op">(</span></span></span>
<span class="r-in"><span>        data <span class="op">=</span> <span class="va">d</span>,</span></span>
<span class="r-in"><span>        idvar <span class="op">=</span> <span class="st">"ID"</span>,</span></span>
<span class="r-in"><span>        assessmentvar <span class="op">=</span> <span class="st">"Assess"</span>,</span></span>
<span class="r-in"><span>        dv <span class="op">=</span> <span class="va">tuneGrid</span><span class="op">$</span><span class="va">dv</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>        timevars <span class="op">=</span> <span class="va">tuneGrid</span><span class="op">$</span><span class="va">timevars</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>        misstrick <span class="op">=</span> <span class="va">tuneGrid</span><span class="op">$</span><span class="va">misstrick</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>        k <span class="op">=</span> <span class="va">tuneGrid</span><span class="op">$</span><span class="va">k</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>        title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">tuneGrid</span><span class="op">$</span><span class="va">title</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">tuneGrid</span><span class="op">$</span><span class="va">k</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        base <span class="op">=</span> <span class="va">tuneGrid</span><span class="op">$</span><span class="va">base</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>        run <span class="op">=</span> <span class="va">tuneGrid</span><span class="op">$</span><span class="va">run</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>        processors <span class="op">=</span> <span class="va">tuneGrid</span><span class="op">$</span><span class="va">processors</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>        starts <span class="op">=</span> <span class="va">tuneGrid</span><span class="op">$</span><span class="va">starts</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>        newdata <span class="op">=</span> <span class="va">nd</span>,</span></span>
<span class="r-in"><span>        cov <span class="op">=</span> <span class="va">tuneGrid</span><span class="op">$</span><span class="va">cov</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">mres</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michael Hallquist, Joshua Wiley.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

