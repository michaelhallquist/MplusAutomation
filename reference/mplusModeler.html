<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Create, run, and read Mplus models. — mplusModeler • MplusAutomation</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create, run, and read Mplus models. — mplusModeler"><meta name="description" content="This is a convenience wrapper to automate many of the
usual steps required to run an Mplus model. It relies in part
on functions from the MplusAutomation package."><meta property="og:description" content="This is a convenience wrapper to automate many of the
usual steps required to run an Mplus model. It relies in part
on functions from the MplusAutomation package."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MplusAutomation</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/submitModels.html">Submitting Many Mplus Models to an HPC with submitModels()</a></li>
    <li><a class="dropdown-item" href="../articles/vignette.html">MplusAutomation Examples</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/michaelhallquist/MplusAutomation/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Create, run, and read Mplus models.</h1>
      <small class="dont-index">Source: <a href="https://github.com/michaelhallquist/MplusAutomation/blob/master/R/mplus.R" class="external-link"><code>R/mplus.R</code></a></small>
      <div class="d-none name"><code>mplusModeler.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This is a convenience wrapper to automate many of the
usual steps required to run an Mplus model. It relies in part
on functions from the MplusAutomation package.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mplusModeler</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">dataout</span>,</span>
<span>  <span class="va">modelout</span>,</span>
<span>  run <span class="op">=</span> <span class="fl">0L</span>,</span>
<span>  check <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  varwarnings <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  Mplus_command <span class="op">=</span> <span class="fu"><a href="detectMplus.html">detectMplus</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  writeData <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ifmissing"</span>, <span class="st">"always"</span>, <span class="st">"never"</span><span class="op">)</span>,</span>
<span>  hashfilename <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  killOnFail <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>An object of class mplusObject</p></dd>


<dt id="arg-dataout">dataout<a class="anchor" aria-label="anchor" href="#arg-dataout"></a></dt>
<dd><p>the name of the file to output the data to for Mplus.
If missing, defaults to <code>modelout</code> changing .inp to .dat.</p></dd>


<dt id="arg-modelout">modelout<a class="anchor" aria-label="anchor" href="#arg-modelout"></a></dt>
<dd><p>the name of the output file for the model.
This is the file all the syntax is written to, which becomes the
Mplus input file. It should end in .inp.  If missing, defaults to
<code>dataout</code> changing the extension to .inp.</p></dd>


<dt id="arg-run">run<a class="anchor" aria-label="anchor" href="#arg-run"></a></dt>
<dd><p>an integer indicating how many models should be run. Defaults to zero.
If zero, the data and model input files are all created, but the model is not run.
This can be useful for seeing how the function works and what setup is done. If one, a basic
model is run. If greater than one, the model is bootstrapped with <code>run</code> replications as
well as the basic model.</p></dd>


<dt id="arg-check">check<a class="anchor" aria-label="anchor" href="#arg-check"></a></dt>
<dd><p>logical whether the body of the Mplus syntax should be checked for missing
semicolons using the <code><a href="parseMplus.html">parseMplus</a></code> function. Defaults to <code>FALSE</code>.</p></dd>


<dt id="arg-varwarnings">varwarnings<a class="anchor" aria-label="anchor" href="#arg-varwarnings"></a></dt>
<dd><p>A logical whether warnings about variable length should be left, the
default, or removed from the output file.</p></dd>


<dt id="arg-mplus-command">Mplus_command<a class="anchor" aria-label="anchor" href="#arg-mplus-command"></a></dt>
<dd><p>optional. N.B.: No need to pass this parameter for most users (has intelligent
defaults). Allows the user to specify the name/path of the Mplus executable to be used for
running models. This covers situations where Mplus is not in the system's path,
or where one wants to test different versions of the Mplus program.</p></dd>


<dt id="arg-writedata">writeData<a class="anchor" aria-label="anchor" href="#arg-writedata"></a></dt>
<dd><p>A character vector, one of ‘ifmissing’,
‘always’, ‘never’ indicating whether the data files
(*.dat) should be written to disk.  This is passed on to <code>prepareMplusData</code>.
Note that previously, <code>mplusModeler</code> always (re)wrote the data to disk.
However, now the default is to write the data to disk only if it is missing
(i.e., ‘ifmissing’).  See details for further information.</p></dd>


<dt id="arg-hashfilename">hashfilename<a class="anchor" aria-label="anchor" href="#arg-hashfilename"></a></dt>
<dd><p>A logical whether or not to add a hash of the raw data to the
data file name.  Defaults to <code>TRUE</code> in <code>mplusModeler</code>.  Note that this
behavior is a change from previous versions and differs from <code>prepareMplusData</code>
which maintains the old behavior by default of <code>FALSE</code>.</p></dd>


<dt id="arg-killonfail">killOnFail<a class="anchor" aria-label="anchor" href="#arg-killonfail"></a></dt>
<dd><p>A logical whether or not to kill any mplus processes on failure.
Passed on to control behavior of <code><a href="runModels.html">runModels</a></code>. Defaults to <code>TRUE</code>.</p></dd>


<dt id="arg-quiet">quiet<a class="anchor" aria-label="anchor" href="#arg-quiet"></a></dt>
<dd><p>optional. If <code>TRUE</code>, show status messages in the console.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments passed to the
<code><a href="prepareMplusData.html">prepareMplusData</a></code> function.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An Mplus model object, with results.
  If <code>run = 1</code>, returns an invisible list of results from the run of
  the Mplus model (see <code><a href="readModels.html">readModels</a></code> from the
  MplusAutomation package). If <code>run = 0</code>, the function returns a list
  with two elements, ‘model’ and ‘boot’ that are both <code>NULL</code>.
  if <code>run &gt;= 1</code>,returns a list with two elements, ‘model’ and ‘boot’
  containing the regular Mplus model output and the boot object, respectively.
  In all cases, the Mplus data file and input files are created.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Combined with functions from the MplusAutomation package,
this function is designed to make it easy to fit Mplus models
from R and to ease many of the usual frustrations with Mplus.
For example, Mplus has very specific formats it accepts data in,
but also very little data management facilities. Using <span style="R">R</span> data
management is easy. This function is designed to make using data
from <span style="R">R</span> in Mplus models easy.
It is also common to want to fit many different models that are
slight variants. This can be tedius in Mplus, but using <span style="R">R</span> you can
create one basic set of input, store it in a vector, and then just
modify that (e.g., using regular expressions) and pass it to Mplus.
You can even use loops or the <code>*apply</code> constructs to fit the same
sort of model with little variants.</p>
<p>The <code>writeData</code> argument is new and can be used to reduce overhead
from repeatedly writing the same data from R to the disk.  When using the
‘always’ option, <code>mplusModeler</code> behaves as before, always writing
data from R to the disk.  This remains the default for the <code>prepareMplusData</code>
function to avoid confusion or breaking old code.  However, for <code>mplusModeler</code>,
the default has been set to ‘ifmissing’.  In this case, R generates an
md5 hash of the data prior to writing it out to the disk.  The md5 hash is based on:
(1) the dimensions of the dataset, (2) the variable names,
(3) the class of every variable, and (4) the raw data from the first and last rows.
This combination ensures that under most all circumstances, if the data changes,
the hash will change.  The hash is appended to the specified data file name
(which is controlled by the logical <code>hashfilename</code> argument).  Next R
checks in the directory where the data would normally be written.  If a data file
exists in that directory that matches the hash generated from the data, R will
use that existing data file instead of writing out the data again.
A final option is ‘never’.  If this option is used, R will not write
the data out even if no file matching the hash is found.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="runModels.html">runModels</a></code> and <code><a href="readModels.html">readModels</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Joshua F. Wiley &lt;jwiley.psych@gmail.com&gt;</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># minimal example of a model using builtin data, allowing R</span></span></span>
<span class="r-in"><span><span class="co"># to automatically guess the correct variables to use</span></span></span>
<span class="r-in"><span><span class="va">test</span> <span class="op">&lt;-</span> <span class="fu"><a href="mplusObject.html">mplusObject</a></span><span class="op">(</span>MODEL <span class="op">=</span> <span class="st">"mpg ON wt hp;</span></span></span>
<span class="r-in"><span><span class="st">  wt WITH hp;"</span>, rdata <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co"># estimate the model in Mplus and read results back into R</span></span></span>
<span class="r-in"><span> <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">mplusModeler</span><span class="op">(</span><span class="va">test</span>, modelout <span class="op">=</span> <span class="st">"model1.inp"</span>, run <span class="op">=</span> <span class="fl">1L</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co"># when forcing writeData = "always" data gets overwritten (with a warning)</span></span></span>
<span class="r-in"><span> <span class="va">resb</span> <span class="op">&lt;-</span> <span class="fu">mplusModeler</span><span class="op">(</span><span class="va">test</span>, modelout <span class="op">=</span> <span class="st">"model1.inp"</span>, run <span class="op">=</span> <span class="fl">1L</span>,</span></span>
<span class="r-in"><span>                      writeData <span class="op">=</span> <span class="st">"always"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co"># using writeData = "ifmissing", the default, no data re-written</span></span></span>
<span class="r-in"><span> <span class="va">resc</span> <span class="op">&lt;-</span> <span class="fu">mplusModeler</span><span class="op">(</span><span class="va">test</span>, modelout <span class="op">=</span> <span class="st">"model1.inp"</span>, run <span class="op">=</span> <span class="fl">1L</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co"># using writeData = "ifmissing", the default, data ARE written</span></span></span>
<span class="r-in"><span> <span class="co"># if data changes</span></span></span>
<span class="r-in"><span> <span class="va">test</span> <span class="op">&lt;-</span> <span class="fu"><a href="mplusObject.html">mplusObject</a></span><span class="op">(</span>MODEL <span class="op">=</span> <span class="st">"mpg ON wt hp;</span></span></span>
<span class="r-in"><span><span class="st">   wt WITH hp;"</span>, rdata <span class="op">=</span> <span class="va">mtcars</span><span class="op">[</span><span class="op">-</span><span class="fl">10</span>, <span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">resd</span> <span class="op">&lt;-</span> <span class="fu">mplusModeler</span><span class="op">(</span><span class="va">test</span>, modelout <span class="op">=</span> <span class="st">"model1.inp"</span>, run <span class="op">=</span> <span class="fl">1L</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co"># show summary</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">resd</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co"># show coefficients</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">resd</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co"># what if you wanted confidence intervals</span></span></span>
<span class="r-in"><span> <span class="co"># and standardized values?</span></span></span>
<span class="r-in"><span> <span class="co"># first update to tell Mplus you want them, re-run and print</span></span></span>
<span class="r-in"><span> <span class="va">test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">test</span>, OUTPUT <span class="op">=</span> <span class="op">~</span> <span class="st">"CINTERVAL; STDYX;"</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">resd</span> <span class="op">&lt;-</span> <span class="fu">mplusModeler</span><span class="op">(</span><span class="va">test</span>, modelout <span class="op">=</span> <span class="st">"model1.inp"</span>, run <span class="op">=</span> <span class="fl">1L</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">resd</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">resd</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># now standardized</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">resd</span>, type <span class="op">=</span> <span class="st">"stdyx"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">resd</span>, type <span class="op">=</span> <span class="st">"stdyx"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># put together in one data frame if desired</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">resd</span>, type <span class="op">=</span> <span class="st">"stdyx"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">resd</span>, type <span class="op">=</span> <span class="st">"stdyx"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  by <span class="op">=</span> <span class="st">"Label"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co"># remove files</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="va">resc</span><span class="op">$</span><span class="va">results</span><span class="op">$</span><span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">file</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="va">resd</span><span class="op">$</span><span class="va">results</span><span class="op">$</span><span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">file</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="st">"model1.inp"</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="st">"model1.out"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># simple example of a model using builtin data</span></span></span>
<span class="r-in"><span><span class="co"># demonstrates use with a few more sections</span></span></span>
<span class="r-in"><span><span class="va">test2</span> <span class="op">&lt;-</span> <span class="fu"><a href="mplusObject.html">mplusObject</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  TITLE <span class="op">=</span> <span class="st">"test the MplusAutomation Package and mplusModeler wrapper;"</span>,</span></span>
<span class="r-in"><span>  MODEL <span class="op">=</span> <span class="st">"</span></span></span>
<span class="r-in"><span><span class="st">    mpg ON wt hp;</span></span></span>
<span class="r-in"><span><span class="st">    wt WITH hp;"</span>,</span></span>
<span class="r-in"><span>  usevariables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mpg"</span>, <span class="st">"wt"</span>, <span class="st">"hp"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  rdata <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="va">res2</span> <span class="op">&lt;-</span> <span class="fu">mplusModeler</span><span class="op">(</span><span class="va">test2</span>, modelout <span class="op">=</span> <span class="st">"model2.inp"</span>, run <span class="op">=</span> <span class="fl">1L</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co"># remove files</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="va">res2</span><span class="op">$</span><span class="va">results</span><span class="op">$</span><span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">file</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="st">"model2.inp"</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="st">"model2.out"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co"># similar example using a robust estimator for standard errors</span></span></span>
<span class="r-in"><span> <span class="co"># and showing how an existing model can be easily updated and reused</span></span></span>
<span class="r-in"><span> <span class="va">test3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">test2</span>, ANALYSIS <span class="op">=</span> <span class="op">~</span> <span class="st">"ESTIMATOR = MLR;"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="va">res3</span> <span class="op">&lt;-</span> <span class="fu">mplusModeler</span><span class="op">(</span><span class="va">test3</span>, modelout <span class="op">=</span> <span class="st">"model3.inp"</span>, run <span class="op">=</span> <span class="fl">1L</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="va">res3</span><span class="op">$</span><span class="va">results</span><span class="op">$</span><span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">file</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="st">"model3.inp"</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="st">"model3.out"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co"># now use the built in bootstrapping methods</span></span></span>
<span class="r-in"><span> <span class="co"># note that these work, even when Mplus will not bootstrap</span></span></span>
<span class="r-in"><span> <span class="co"># also note how categorical variables and weights are declared</span></span></span>
<span class="r-in"><span> <span class="co"># in particular, the usevariables for Mplus must be specified</span></span></span>
<span class="r-in"><span> <span class="co"># because mroe variables are included in the data than are in the</span></span></span>
<span class="r-in"><span> <span class="co"># model. Note the R usevariables includes all variables for both</span></span></span>
<span class="r-in"><span> <span class="co"># model and weights. The same is true for clustering.</span></span></span>
<span class="r-in"><span> <span class="va">test4</span> <span class="op">&lt;-</span> <span class="fu"><a href="mplusObject.html">mplusObject</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>   TITLE <span class="op">=</span> <span class="st">"test bootstrapping;"</span>,</span></span>
<span class="r-in"><span>   VARIABLE <span class="op">=</span> <span class="st">"</span></span></span>
<span class="r-in"><span><span class="st">     CATEGORICAL = cyl;</span></span></span>
<span class="r-in"><span><span class="st">     WEIGHT = wt;</span></span></span>
<span class="r-in"><span><span class="st">     USEVARIABLES = cyl mpg;"</span>,</span></span>
<span class="r-in"><span>   ANALYSIS <span class="op">=</span> <span class="st">"ESTIMATOR = MLR;"</span>,</span></span>
<span class="r-in"><span>   MODEL <span class="op">=</span> <span class="st">"</span></span></span>
<span class="r-in"><span><span class="st">     cyl ON mpg;"</span>,</span></span>
<span class="r-in"><span>   usevariables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mpg"</span>, <span class="st">"wt"</span>, <span class="st">"cyl"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   rdata <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="va">res4</span> <span class="op">&lt;-</span> <span class="fu">mplusModeler</span><span class="op">(</span><span class="va">test4</span>, <span class="st">"mtcars.dat"</span>, modelout <span class="op">=</span> <span class="st">"model4.inp"</span>, run <span class="op">=</span> <span class="fl">10L</span>,</span></span>
<span class="r-in"><span>   hashfilename <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="co"># see the results</span></span></span>
<span class="r-in"><span> <span class="va">res4</span><span class="op">$</span><span class="va">results</span><span class="op">$</span><span class="va">boot</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co"># remove files</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="st">"mtcars.dat"</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="st">"model4.inp"</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="st">"model4.out"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Monte Carlo Simulation Example</span></span></span>
<span class="r-in"><span><span class="va">montecarlo</span> <span class="op">&lt;-</span> <span class="fu"><a href="mplusObject.html">mplusObject</a></span><span class="op">(</span></span></span>
<span class="r-in"><span> TITLE <span class="op">=</span> <span class="st">"Monte Carlo Example;"</span>,</span></span>
<span class="r-in"><span> MONTECARLO <span class="op">=</span> <span class="st">"</span></span></span>
<span class="r-in"><span><span class="st">  NAMES ARE i1-i5;</span></span></span>
<span class="r-in"><span><span class="st">  NOBSERVATIONS = 100;</span></span></span>
<span class="r-in"><span><span class="st">  NREPS = 100;</span></span></span>
<span class="r-in"><span><span class="st">  SEED = 1234;"</span>,</span></span>
<span class="r-in"><span> MODELPOPULATION <span class="op">=</span> <span class="st">"</span></span></span>
<span class="r-in"><span><span class="st">  f BY i1-i5*1;</span></span></span>
<span class="r-in"><span><span class="st">  f@1;</span></span></span>
<span class="r-in"><span><span class="st">  i1-i5*1;"</span>,</span></span>
<span class="r-in"><span> ANALYSIS <span class="op">=</span> <span class="st">"</span></span></span>
<span class="r-in"><span><span class="st">  ESTIMATOR = BAYES;</span></span></span>
<span class="r-in"><span><span class="st">  PROC = 2;</span></span></span>
<span class="r-in"><span><span class="st">  fbiter = 100;"</span>,</span></span>
<span class="r-in"><span> MODEL <span class="op">=</span> <span class="st">"</span></span></span>
<span class="r-in"><span><span class="st">  f BY i1-i5*.8 (l1-l5);</span></span></span>
<span class="r-in"><span><span class="st">  f@1;</span></span></span>
<span class="r-in"><span><span class="st">  i1-i5*1;"</span>,</span></span>
<span class="r-in"><span> MODELPRIORS <span class="op">=</span> <span class="st">"</span></span></span>
<span class="r-in"><span><span class="st">   l1-l5 ~ N(.5 .1);"</span>,</span></span>
<span class="r-in"><span> OUTPUT <span class="op">=</span> <span class="st">"TECH9;"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fitMonteCarlo</span> <span class="op">&lt;-</span> <span class="fu">mplusModeler</span><span class="op">(</span><span class="va">montecarlo</span>,</span></span>
<span class="r-in"><span>  modelout <span class="op">=</span> <span class="st">"montecarlo.inp"</span>,</span></span>
<span class="r-in"><span>  run <span class="op">=</span> <span class="fl">1L</span>,</span></span>
<span class="r-in"><span>  writeData <span class="op">=</span> <span class="st">"always"</span>,</span></span>
<span class="r-in"><span>  hashfilename <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="st">"montecarlo.inp"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="st">"montecarlo.out"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example including ID variable and extracting factor scores</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">mtcars</span></span></span>
<span class="r-in"><span><span class="va">dat</span><span class="op">$</span><span class="va">UID</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">testIDs</span> <span class="op">&lt;-</span> <span class="fu"><a href="mplusObject.html">mplusObject</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  TITLE <span class="op">=</span> <span class="st">"test the mplusModeler wrapper with IDs;"</span>,</span></span>
<span class="r-in"><span>  VARIABLE <span class="op">=</span> <span class="st">"IDVARIABLE = UID;"</span>,</span></span>
<span class="r-in"><span>  MODEL <span class="op">=</span> <span class="st">"</span></span></span>
<span class="r-in"><span><span class="st">    F BY mpg wt hp;"</span>,</span></span>
<span class="r-in"><span>  SAVEDATA <span class="op">=</span> <span class="st">"</span></span></span>
<span class="r-in"><span><span class="st">    FILE IS testid_fscores.dat;</span></span></span>
<span class="r-in"><span><span class="st">    SAVE IS fscores;</span></span></span>
<span class="r-in"><span><span class="st">    FORMAT IS free;"</span>,</span></span>
<span class="r-in"><span>  usevariables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"UID"</span>, <span class="st">"mpg"</span>, <span class="st">"wt"</span>, <span class="st">"hp"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  rdata <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="va">resIDs</span> <span class="op">&lt;-</span> <span class="fu">mplusModeler</span><span class="op">(</span><span class="va">testIDs</span>, modelout <span class="op">=</span> <span class="st">"testid.inp"</span>, run <span class="op">=</span> <span class="fl">1L</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># view the saved data from Mplus, including factor scores</span></span></span>
<span class="r-in"><span><span class="co"># the indicator variables, and the ID variable we specified</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">resIDs</span><span class="op">$</span><span class="va">results</span><span class="op">$</span><span class="va">savedata</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># merge the factor scores with the rest of the original data</span></span></span>
<span class="r-in"><span><span class="co"># merge together by the ID column</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">dat</span>, <span class="va">resIDs</span><span class="op">$</span><span class="va">results</span><span class="op">$</span><span class="va">savedata</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"F"</span>, <span class="st">"UID"</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  by <span class="op">=</span> <span class="st">"UID"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># correlate merged factor scores against some other new variable</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="cn">F</span>, <span class="va">qsec</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># can write multiply imputed data too</span></span></span>
<span class="r-in"><span><span class="co"># here are three "imputed" datasets</span></span></span>
<span class="r-in"><span><span class="va">idat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>mpg <span class="op">=</span> <span class="va">mtcars</span><span class="op">$</span><span class="va">mpg</span>, hp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="va">mtcars</span><span class="op">$</span><span class="va">hp</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>mpg <span class="op">=</span> <span class="va">mtcars</span><span class="op">$</span><span class="va">mpg</span>, hp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">110</span>, <span class="va">mtcars</span><span class="op">$</span><span class="va">hp</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>mpg <span class="op">=</span> <span class="va">mtcars</span><span class="op">$</span><span class="va">mpg</span>, hp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">120</span>, <span class="va">mtcars</span><span class="op">$</span><span class="va">hp</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># if we turn on hashing in the filename the first time,</span></span></span>
<span class="r-in"><span><span class="co"># we can avoid overwriting notes the second time</span></span></span>
<span class="r-in"><span><span class="va">testobjimp</span> <span class="op">&lt;-</span> <span class="fu"><a href="mplusObject.html">mplusObject</a></span><span class="op">(</span>MODEL <span class="op">=</span> <span class="st">"[mpg];"</span>, rdata <span class="op">=</span> <span class="va">idat</span>, imputed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">testimp</span> <span class="op">&lt;-</span> <span class="fu">mplusModeler</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">testobjimp</span>,</span></span>
<span class="r-in"><span>  modelout <span class="op">=</span> <span class="st">"testimp.inp"</span>,</span></span>
<span class="r-in"><span>  writeData <span class="op">=</span> <span class="st">"ifmissing"</span>, hashfilename<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">testimp</span> <span class="op">&lt;-</span> <span class="fu">mplusModeler</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">testobjimp</span>,</span></span>
<span class="r-in"><span>  modelout <span class="op">=</span> <span class="st">"testimp.inp"</span>,</span></span>
<span class="r-in"><span>  writeData <span class="op">=</span> <span class="st">"ifmissing"</span>, hashfilename<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">testimp</span> <span class="op">&lt;-</span> <span class="fu">mplusModeler</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">testobjimp</span>,</span></span>
<span class="r-in"><span>  modelout <span class="op">=</span> <span class="st">"testimp.inp"</span>,</span></span>
<span class="r-in"><span>  writeData <span class="op">=</span> <span class="st">"ifmissing"</span>, hashfilename<span class="op">=</span><span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  run <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">testobjimp2</span> <span class="op">&lt;-</span> <span class="fu"><a href="mplusObject.html">mplusObject</a></span><span class="op">(</span>MODEL <span class="op">=</span> <span class="st">"[hp];"</span>, rdata <span class="op">=</span> <span class="va">idat</span>, imputed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">testimp2</span> <span class="op">&lt;-</span> <span class="fu">mplusModeler</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">testobjimp2</span>,</span></span>
<span class="r-in"><span>  modelout <span class="op">=</span> <span class="st">"testimp2.inp"</span>,</span></span>
<span class="r-in"><span>  writeData <span class="op">=</span> <span class="st">"ifmissing"</span>, hashfilename<span class="op">=</span><span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  run <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co"># remove files</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="va">resIDs</span><span class="op">$</span><span class="va">results</span><span class="op">$</span><span class="va">input</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">file</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="st">"testid.inp"</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="st">"testid.out"</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="st">"testid_fscores.dat"</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="st">"Mplus Run Models.log"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michael Hallquist, Joshua Wiley.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

